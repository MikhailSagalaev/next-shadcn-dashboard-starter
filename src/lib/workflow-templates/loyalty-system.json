{
  "name": "–°–∏—Å—Ç–µ–º–∞ –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏",
  "description": "–£–º–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —Ñ–ª–æ—É —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –Ω–∞ —Å–∞–π—Ç–µ. –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–µ –±–æ–Ω—É—Å—ã –Ω–∞—á–∏—Å–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏.",
  "nodes": [
    {
      "id": "start-trigger",
      "type": "trigger.command",
      "position": { "x": 100, "y": 100 },
      "data": {
        "label": "–ö–æ–º–∞–Ω–¥–∞ /start",
        "command": "/start",
        "description": "–ó–∞–ø—É—Å–∫ –±–æ—Ç–∞"
      }
    },
    {
      "id": "welcome-message",
      "type": "message.text",
      "position": { "x": 100, "y": 200 },
      "data": {
        "label": "–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ",
        "text": "üéÅ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –ø—Ä–æ–≥—Ä–∞–º–º—É –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏!\n\nüí∞ –ü–æ–ª—É—á–∏—Ç–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–µ –±–æ–Ω—É—Å—ã –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å!\n\nüì± –î–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥–µ–ª–∏—Ç–µ—Å—å –≤–∞—à–∏–º –Ω–æ–º–µ—Ä–æ–º —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –∏–ª–∏ —É–∫–∞–∂–∏—Ç–µ email."
      }
    },
    {
      "id": "request-contact",
      "type": "trigger.contact",
      "position": { "x": 100, "y": 300 },
      "data": {
        "label": "–ó–∞–ø—Ä–æ—Å –∫–æ–Ω—Ç–∞–∫—Ç–∞",
        "requestPhone": true,
        "buttonText": "üì± –ü–æ–¥–µ–ª–∏—Ç—å—Å—è –Ω–æ–º–µ—Ä–æ–º"
      }
    },
    {
      "id": "check-user",
      "type": "action.check_user",
      "position": { "x": 100, "y": 400 },
      "data": {
        "label": "–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",
        "telegramId": "{{telegram.userId}}",
        "phone": "{{telegram.contact.phone}}",
        "email": "{{telegram.message.text}}"
      }
    },
    {
      "id": "is-new-user",
      "type": "condition",
      "position": { "x": 100, "y": 500 },
      "data": {
        "label": "–ù–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å?",
        "expression": "!get('user') || !get('user').id"
      }
    },
    {
      "id": "create-user",
      "type": "action.create_user",
      "position": { "x": -100, "y": 600 },
      "data": {
        "label": "–°–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",
        "telegramId": "{{telegram.userId}}",
        "username": "{{telegram.username}}",
        "firstName": "{{telegram.firstName}}",
        "phone": "{{telegram.contact.phone}}",
        "email": "{{telegram.message.text}}"
      }
    },
    {
      "id": "add-welcome-bonus",
      "type": "action.add_bonus",
      "position": { "x": -100, "y": 700 },
      "data": {
        "label": "–ù–∞—á–∏—Å–ª–∏—Ç—å –±–æ–Ω—É—Å—ã",
        "userId": "{{user.id}}",
        "amount": 100,
        "type": "WELCOME",
        "description": "–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–µ –±–æ–Ω—É—Å—ã"
      }
    },
    {
      "id": "success-new-user",
      "type": "message.text",
      "position": { "x": -100, "y": 800 },
      "data": {
        "label": "–£—Å–ø–µ—à–Ω–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è",
        "text": "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º —Å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–µ–π!\n\nüí∞ –í–∞–º –Ω–∞—á–∏—Å–ª–µ–Ω–æ 100 –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã—Ö –±–æ–Ω—É—Å–æ–≤!\n\n‚ú® –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∏—Ö –¥–ª—è –ø–æ–∫—É–ø–æ–∫ –∏ –ø–æ–ª—É—á–∞–π—Ç–µ –≤—ã–≥–æ–¥—É!"
      }
    },
    {
      "id": "existing-user-message",
      "type": "message.text",
      "position": { "x": 300, "y": 600 },
      "data": {
        "label": "–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ",
        "text": "üëã –†–∞–¥—ã –≤–∏–¥–µ—Ç—å –≤–∞—Å —Å–Ω–æ–≤–∞!\n\nüí∞ –í–∞—à —Ç–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å: {{user.balance}} –±–æ–Ω—É—Å–æ–≤\n\nüõçÔ∏è –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –¥–µ–ª–∞—Ç—å –ø–æ–∫—É–ø–∫–∏ –∏ –∫–æ–ø–∏—Ç—å –±–æ–Ω—É—Å—ã!"
      }
    },
    {
      "id": "end-node",
      "type": "flow.end",
      "position": { "x": 100, "y": 900 },
      "data": {
        "label": "–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ",
        "success": true
      }
    }
  ],
  "connections": [
    {
      "id": "start-to-welcome",
      "source": "start-trigger",
      "target": "welcome-message",
      "type": "default"
    },
    {
      "id": "welcome-to-request",
      "source": "welcome-message",
      "target": "request-contact",
      "type": "default"
    },
    {
      "id": "request-to-check",
      "source": "request-contact",
      "target": "check-user",
      "type": "default"
    },
    {
      "id": "check-to-condition",
      "source": "check-user",
      "target": "is-new-user",
      "type": "default"
    },
    {
      "id": "condition-to-create",
      "source": "is-new-user",
      "target": "create-user",
      "type": "true"
    },
    {
      "id": "create-to-bonus",
      "source": "create-user",
      "target": "add-welcome-bonus",
      "type": "default"
    },
    {
      "id": "bonus-to-success",
      "source": "add-welcome-bonus",
      "target": "success-new-user",
      "type": "default"
    },
    {
      "id": "success-to-end",
      "source": "success-new-user",
      "target": "end-node",
      "type": "default"
    },
    {
      "id": "condition-to-existing",
      "source": "is-new-user",
      "target": "existing-user-message",
      "type": "false"
    },
    {
      "id": "existing-to-end",
      "source": "existing-user-message",
      "target": "end-node",
      "type": "default"
    }
  ],
  "variables": [
    {
      "name": "user",
      "type": "object",
      "description": "–î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö"
    },
    {
      "name": "welcome_bonus",
      "type": "number",
      "value": 100,
      "description": "–†–∞–∑–º–µ—Ä –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –±–æ–Ω—É—Å–∞"
    }
  ],
  "settings": {
    "maxExecutionTime": 60000,
    "retryAttempts": 3
  }
}
