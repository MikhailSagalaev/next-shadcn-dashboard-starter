 {
  "name": "–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ Email",
  "description": "–°–∏—Å—Ç–µ–º–∞ –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏ —Å –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π –ø–æ email. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç email –¥–ª—è –ø—Ä–∏–≤—è–∑–∫–∏ –∞–∫–∫–∞—É–Ω—Ç–∞, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –¥–∞—Ç—É —Ä–æ–∂–¥–µ–Ω–∏—è –∏ —Ç–µ–ª–µ—Ñ–æ–Ω.",
  "version": 1,
  "nodes": [
    {
      "id": "start-trigger",
      "type": "trigger.command",
      "data": {
        "label": "–ö–æ–º–∞–Ω–¥–∞ /start",
        "config": {
          "trigger.command": {
            "command": "/start"
          }
        }
      },
      "position": { "x": 0, "y": 307.5 }
    },
    {
      "id": "contact-trigger",
      "type": "trigger.contact",
      "data": {
        "label": "–ü–æ–ª—É—á–µ–Ω –∫–æ–Ω—Ç–∞–∫—Ç",
        "config": {
          "trigger.contact": {}
        }
      },
      "position": { "x": 0, "y": 600 }
    },
    {
      "id": "check-contact-user",
      "type": "action.database_query",
      "data": {
        "label": "–ù–∞–π—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –∫–æ–Ω—Ç–∞–∫—Ç–∞",
        "config": {
          "action.database_query": {
            "query": "check_user_by_telegram",
            "assignTo": "contactUser",
            "parameters": {
              "projectId": "{{projectId}}",
              "telegramId": "{{telegram.userId}}"
            }
          }
        }
      },
      "position": { "x": 406, "y": 600 }
    },
    {
      "id": "check-contact-user-exists",
      "type": "condition",
      "data": {
        "label": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–π–¥–µ–Ω?",
        "config": {
          "condition": {
            "operator": "is_not_empty",
            "variable": "contactUser"
          }
        }
      },
      "position": { "x": 812, "y": 600 }
    },
    {
      "id": "save-contact-phone",
      "type": "action.database_query",
      "data": {
        "label": "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–µ–ª–µ—Ñ–æ–Ω –∏–∑ –∫–æ–Ω—Ç–∞–∫—Ç–∞",
        "config": {
          "action.database_query": {
            "query": "update_user_contact",
            "parameters": {
              "telegramId": "{{telegram.userId}}",
              "projectId": "{{projectId}}",
              "phone": "{{telegram.contact.phoneNumber}}"
            }
          }
        }
      },
      "position": { "x": 1218, "y": 500 }
    },
    {
      "id": "contact-saved-message",
      "type": "message",
      "data": {
        "label": "–¢–µ–ª–µ—Ñ–æ–Ω —Å–æ—Ö—Ä–∞–Ω—ë–Ω",
        "config": {
          "message": {
            "text": "‚úÖ –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω—ë–Ω!\n\nüì± –í–∞—à —Ç–µ–ª–µ—Ñ–æ–Ω: {user.phone}\n\nüí∞ –ë–∞–ª–∞–Ω—Å: {user.balanceFormatted}",
            "keyboard": {
              "type": "inline",
              "buttons": [
                [{ "text": "üìã –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é", "callback_data": "menu_main" }]
              ]
            }
          }
        }
      },
      "position": { "x": 1624, "y": 500 }
    },
    {
      "id": "contact-user-not-found",
      "type": "message",
      "data": {
        "label": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω –¥–ª—è –∫–æ–Ω—Ç–∞–∫—Ç–∞",
        "config": {
          "message": {
            "text": "‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è.\n\n–ù–∞–∂–º–∏—Ç–µ /start –¥–ª—è –Ω–∞—á–∞–ª–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏.",
            "keyboard": {
              "type": "remove"
            }
          }
        }
      },
      "position": { "x": 1218, "y": 700 }
    },
    {
      "id": "check-telegram-user",
      "type": "action.database_query",
      "data": {
        "label": "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ Telegram ID",
        "config": {
          "action.database_query": {
            "query": "check_user_by_telegram",
            "assignTo": "telegramUser",
            "parameters": {
              "projectId": "{{projectId}}",
              "telegramId": "{{telegram.userId}}"
            }
          }
        }
      },
      "position": { "x": 406, "y": 307.5 }
    },
    {
      "id": "check-user-status",
      "type": "condition",
      "data": {
        "label": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–π–¥–µ–Ω?",
        "config": {
          "condition": {
            "operator": "is_not_empty",
            "variable": "telegramUser"
          }
        }
      },
      "position": { "x": 812, "y": 307.5 }
    },
    {
      "id": "check-user-active",
      "type": "condition",
      "data": {
        "label": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–∫—Ç–∏–≤–µ–Ω?",
        "config": {
          "condition": {
            "value": true,
            "operator": "equals",
            "variable": "telegramUser.isActive"
          }
        }
      },
      "position": { "x": 1218, "y": 100 }
    },
    {
      "id": "active-user-profile",
      "type": "message",
      "data": {
        "label": "–ü—Ä–æ—Ñ–∏–ª—å –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",
        "config": {
          "message": {
            "text": "üëã –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –Ω–∞–∑–∞–¥, <b>{user.firstName}</b>!\n\nÔøΩ –í–∞—à –±–∞—É–ª–∞–Ω—Å –±–æ–Ω—É—Å–æ–≤: <b>{user.balanceFormatted}</b>\nüìä –í—Å–µ–≥–æ –∑–∞—Ä–∞–±–æ—Ç–∞–Ω–æ: <b>{user.totalEarnedFormatted}</b>\nüõí –ü–æ—Ç—Ä–∞—á–µ–Ω–æ: <b>{user.totalSpentFormatted}</b>\nüèÜ –ò—Å—Ç–µ–∫–∞–µ—Ç –≤ –±–ª–∏–∂–∞–π—à–∏–µ 30 –¥–Ω–µ–π: <b>{user.expiringBonusesFormatted}</b>\n\n–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ:",
            "keyboard": {
              "type": "inline",
              "buttons": [
                [
                  { "text": "üí∞ –ë–∞–ª–∞–Ω—Å", "callback_data": "menu_balance" },
                  { "text": "üìú –ò—Å—Ç–æ—Ä–∏—è", "callback_data": "menu_history" }
                ],
                [
                  { "text": "üèÜ –£—Ä–æ–≤–µ–Ω—å", "callback_data": "menu_level" },
                  { "text": "üë• –†–µ—Ñ–µ—Ä–∞–ª—ã", "callback_data": "menu_referrals" }
                ],
                [
                  { "text": "üîó –ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å", "callback_data": "menu_invite" },
                  { "text": "‚ùì –ü–æ–º–æ—â—å", "callback_data": "menu_help" }
                ]
              ]
            },
            "parseMode": "HTML"
          }
        }
      },
      "position": { "x": 1624, "y": 100 }
    },
    {
      "id": "request-email",
      "type": "message",
      "data": {
        "label": "–ó–∞–ø—Ä–æ—Å–∏—Ç—å Email",
        "config": {
          "message": {
            "text": "üéÅ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –ø—Ä–æ–≥—Ä–∞–º–º—É –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏!\n\nüí∞ –ü–æ–ª—É—á–∏—Ç–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–µ –±–æ–Ω—É—Å—ã –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å!\n\nüìß –î–ª—è –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã –≤–≤–µ–¥–∏—Ç–µ –≤–∞—à email –∞–¥—Ä–µ—Å, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –Ω–∞ —Å–∞–π—Ç–µ:\n\n–ù–∞–ø—Ä–∏–º–µ—Ä: example@mail.ru",
            "keyboard": {
              "type": "remove"
            },
            "waitForInput": true
          }
        }
      },
      "position": { "x": 1624, "y": 500 }
    },
    {
      "id": "wait-email-input",
      "type": "trigger.message",
      "data": {
        "label": "–û–∂–∏–¥–∞–Ω–∏–µ –≤–≤–æ–¥–∞ email",
        "config": {
          "trigger.message": {
            "pattern": ".*"
          }
        }
      },
      "position": { "x": 1830, "y": 500 }
    },
    {
      "id": "check-email-user",
      "type": "action.database_query",
      "data": {
        "label": "–ü–æ–∏—Å–∫ –ø–æ Email",
        "config": {
          "action.database_query": {
            "query": "check_user_by_contact",
            "assignTo": "emailUser",
            "parameters": {
              "email": "{{telegram.message.text}}",
              "projectId": "{{projectId}}"
            }
          }
        }
      },
      "position": { "x": 2030, "y": 500 }
    },
    {
      "id": "check-email-found",
      "type": "condition",
      "data": {
        "label": "Email –Ω–∞–π–¥–µ–Ω?",
        "config": {
          "condition": {
            "operator": "is_not_empty",
            "variable": "emailUser"
          }
        }
      },
      "position": { "x": 2436, "y": 500 }
    },
    {
      "id": "check-telegram-already-linked",
      "type": "condition",
      "data": {
        "label": "Telegram —É–∂–µ –ø—Ä–∏–≤—è–∑–∞–Ω?",
        "config": {
          "condition": {
            "operator": "is_not_empty",
            "variable": "emailUser.telegramId"
          }
        }
      },
      "position": { "x": 2842, "y": 400 }
    },
    {
      "id": "already-active-message",
      "type": "message",
      "data": {
        "label": "–£–∂–µ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω",
        "config": {
          "message": {
            "text": "‚úÖ –í–∞—à –∞–∫–∫–∞—É–Ω—Ç —É–∂–µ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω!\n\nüí∞ –¢–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å: {user.balanceFormatted}\nüìä –£—Ä–æ–≤–µ–Ω—å: {user.currentLevel}\nüéÅ –†–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–π –∫–æ–¥: {user.referralCode}\n\nüõçÔ∏è –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –¥–µ–ª–∞—Ç—å –ø–æ–∫—É–ø–∫–∏ –∏ –∫–æ–ø–∏—Ç—å –±–æ–Ω—É—Å—ã!",
            "keyboard": {
              "type": "inline",
              "buttons": [
                [{ "text": "üìã –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é", "callback_data": "menu_main" }]
              ]
            }
          }
        }
      },
      "position": { "x": 3248, "y": 250 }
    },
    {
      "id": "activate-user",
      "type": "action.database_query",
      "data": {
        "label": "–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",
        "config": {
          "action.database_query": {
            "query": "activate_user",
            "parameters": {
              "userId": "{{emailUser.id}}",
              "telegramId": "{{telegram.userId}}",
              "telegramUsername": "{{telegram.username}}"
            }
          }
        }
      },
      "position": { "x": 3248, "y": 500 }
    },
    {
      "id": "check-welcome-bonus",
      "type": "action.database_query",
      "data": {
        "label": "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–µ –±–æ–Ω—É—Å—ã",
        "config": {
          "action.database_query": {
            "query": "check_welcome_bonus",
            "assignTo": "hasWelcomeBonus",
            "parameters": {
              "userId": "{{emailUser.id}}"
            }
          }
        }
      },
      "position": { "x": 3654, "y": 500 }
    },
    {
      "id": "check-bonus-exists",
      "type": "condition",
      "data": {
        "label": "–ï—Å—Ç—å –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–µ –±–æ–Ω—É—Å—ã?",
        "config": {
          "condition": {
            "value": false,
            "operator": "equals",
            "variable": "hasWelcomeBonus"
          }
        }
      },
      "position": { "x": 4060, "y": 500 }
    },
    {
      "id": "add-welcome-bonus",
      "type": "action.database_query",
      "data": {
        "label": "–ù–∞—á–∏—Å–ª–∏—Ç—å –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–µ –±–æ–Ω—É—Å—ã",
        "config": {
          "action.database_query": {
            "query": "add_bonus",
            "parameters": {
              "type": "WELCOME",
              "amount": "{{project.welcomeBonusAmount}}",
              "userId": "{{emailUser.id}}",
              "description": "–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–µ –±–æ–Ω—É—Å—ã –∑–∞ –∞–∫—Ç–∏–≤–∞—Ü–∏—é –∞–∫–∫–∞—É–Ω—Ç–∞"
            }
          }
        }
      },
      "position": { "x": 4466, "y": 400 }
    },
    {
      "id": "request-birthday",
      "type": "message",
      "data": {
        "label": "–ó–∞–ø—Ä–æ—Å–∏—Ç—å –¥–∞—Ç—É —Ä–æ–∂–¥–µ–Ω–∏—è",
        "config": {
          "message": {
            "text": "üéâ –ê–∫–∫–∞—É–Ω—Ç —É—Å–ø–µ—à–Ω–æ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω!\n\nüéÇ –£–∫–∞–∂–∏—Ç–µ –≤–∞—à—É –¥–∞—Ç—É —Ä–æ–∂–¥–µ–Ω–∏—è, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∞—Ç—å –ø—Ä–∞–∑–¥–Ω–∏—á–Ω—ã–µ –±–æ–Ω—É—Å—ã:\n\n–§–æ—Ä–º–∞—Ç: –î–î.–ú–ú.–ì–ì–ì–ì –∏–ª–∏ –î–î.–ú–ú\n–ù–∞–ø—Ä–∏–º–µ—Ä: 15.03.1990 –∏–ª–∏ 15.03",
            "keyboard": {
              "type": "reply",
              "buttons": [
                [{ "text": "‚è≠Ô∏è –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å" }]
              ]
            },
            "waitForInput": true
          }
        }
      },
      "position": { "x": 4872, "y": 500 }
    },
    {
      "id": "wait-birthday-input",
      "type": "trigger.message",
      "data": {
        "label": "–û–∂–∏–¥–∞–Ω–∏–µ –≤–≤–æ–¥–∞ –¥–∞—Ç—ã —Ä–æ–∂–¥–µ–Ω–∏—è",
        "config": {
          "trigger.message": {
            "pattern": ".*"
          }
        }
      },
      "position": { "x": 5078, "y": 500 }
    },
    {
      "id": "check-birthday-skip",
      "type": "condition",
      "data": {
        "label": "–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å –¥–∞—Ç—É?",
        "config": {
          "condition": {
            "operator": "contains",
            "variable": "telegram.message.text",
            "value": "–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å"
          }
        }
      },
      "position": { "x": 5178, "y": 500 }
    },
    {
      "id": "save-birthday",
      "type": "action.database_query",
      "data": {
        "label": "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–∞—Ç—É —Ä–æ–∂–¥–µ–Ω–∏—è",
        "config": {
          "action.database_query": {
            "query": "update_user_birthday",
            "parameters": {
              "userId": "{{emailUser.id}}",
              "birthDate": "{{telegram.message.text}}"
            }
          }
        }
      },
      "position": { "x": 5278, "y": 500 }
    },
    {
      "id": "request-phone",
      "type": "message",
      "data": {
        "label": "–ó–∞–ø—Ä–æ—Å–∏—Ç—å —Ç–µ–ª–µ—Ñ–æ–Ω",
        "config": {
          "message": {
            "text": "üì± –•–æ—Ç–∏—Ç–µ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏?\n\n–≠—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç –±—ã—Å—Ç—Ä–µ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –∞–∫–∫–∞—É–Ω—Ç—É.",
            "keyboard": {
              "type": "reply",
              "buttons": [
                [{ "text": "üì± –ü–æ–¥–µ–ª–∏—Ç—å—Å—è –∫–æ–Ω—Ç–∞–∫—Ç–æ–º", "request_contact": true }],
                [{ "text": "‚è≠Ô∏è –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å" }]
              ]
            },
            "waitForInput": true
          }
        }
      },
      "position": { "x": 5684, "y": 500 }
    },
    {
      "id": "wait-phone-input",
      "type": "trigger.message",
      "data": {
        "label": "–û–∂–∏–¥–∞–Ω–∏–µ –∫–æ–Ω—Ç–∞–∫—Ç–∞ –∏–ª–∏ –ø—Ä–æ–ø—É—Å–∫–∞",
        "config": {
          "trigger.message": {
            "pattern": ".*"
          }
        }
      },
      "position": { "x": 5890, "y": 500 }
    },
    {
      "id": "check-phone-skip",
      "type": "condition",
      "data": {
        "label": "–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å —Ç–µ–ª–µ—Ñ–æ–Ω?",
        "config": {
          "condition": {
            "operator": "contains",
            "variable": "telegram.message.text",
            "value": "–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å"
          }
        }
      },
      "position": { "x": 5990, "y": 500 }
    },
    {
      "id": "save-phone",
      "type": "action.database_query",
      "data": {
        "label": "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–µ–ª–µ—Ñ–æ–Ω",
        "config": {
          "action.database_query": {
            "query": "update_user_contact",
            "parameters": {
              "telegramId": "{{telegram.userId}}",
              "projectId": "{{projectId}}",
              "phone": "{{telegram.contact.phoneNumber}}"
            }
          }
        }
      },
      "position": { "x": 6090, "y": 400 }
    },
    {
      "id": "success-message",
      "type": "message",
      "data": {
        "label": "–£—Å–ø–µ—à–Ω–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è",
        "config": {
          "message": {
            "text": "üéâ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞!\n\nüí∞ –í–∞—à –±–∞–ª–∞–Ω—Å: {user.balanceFormatted}\nüìä –£—Ä–æ–≤–µ–Ω—å: {user.currentLevel}\nüéÅ –†–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–π –∫–æ–¥: {user.referralCode}\n\n‚ú® –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –ø—Ä–æ–≥—Ä–∞–º–º—É –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏!",
            "keyboard": {
              "type": "inline",
              "buttons": [
                [{ "text": "üìã –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é", "callback_data": "menu_main" }]
              ]
            }
          }
        }
      },
      "position": { "x": 6496, "y": 500 }
    },
    {
      "id": "website-registration",
      "type": "message",
      "data": {
        "label": "–¢—Ä–µ–±—É–µ—Ç—Å—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–∞ —Å–∞–π—Ç–µ",
        "config": {
          "message": {
            "text": "üåê –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º email –Ω–µ –Ω–∞–π–¥–µ–Ω.\n\nüìù –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ –Ω–∞—à–µ–º —Å–∞–π—Ç–µ:\n\nüîó {project.domain}/register\n\n‚ú® –ü–æ—Å–ª–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –≤–µ—Ä–Ω–∏—Ç–µ—Å—å –∏ –≤–≤–µ–¥–∏—Ç–µ email —Å–Ω–æ–≤–∞!",
            "keyboard": {
              "type": "inline",
              "buttons": [
                [{ "text": "üîÑ –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞", "callback_data": "retry_email" }]
              ]
            }
          }
        }
      },
      "position": { "x": 2842, "y": 700 }
    },
    {
      "id": "retry-email-trigger",
      "type": "trigger.callback",
      "data": {
        "label": "–¢—Ä–∏–≥–≥–µ—Ä: –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞",
        "config": {
          "trigger.callback": {
            "callbackData": "retry_email"
          }
        }
      },
      "position": { "x": 3248, "y": 800 }
    },
    {
      "id": "menu-balance-trigger",
      "type": "trigger.callback",
      "data": {
        "label": "–¢—Ä–∏–≥–≥–µ—Ä: –ë–∞–ª–∞–Ω—Å",
        "config": {
          "trigger.callback": {
            "callbackData": "menu_balance"
          }
        }
      },
      "position": { "x": 0, "y": 549.5 }
    },
    {
      "id": "show-balance-details",
      "type": "message",
      "data": {
        "label": "–ü–æ–∫–∞–∑–∞—Ç—å –±–∞–ª–∞–Ω—Å",
        "config": {
          "message": {
            "text": "<b>üí∞ –í–∞—à –±–∞–ª–∞–Ω—Å –±–æ–Ω—É—Å–æ–≤</b>\n\nüíµ <b>–¢–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å:</b> {user.balanceFormatted}\nüìà <b>–í—Å–µ–≥–æ –∑–∞—Ä–∞–±–æ—Ç–∞–Ω–æ:</b> {user.totalEarnedFormatted}\nüìâ <b>–í—Å–µ–≥–æ –ø–æ—Ç—Ä–∞—á–µ–Ω–æ:</b> {user.totalSpentFormatted}\nüõçÔ∏è <b>–ü–æ–∫—É–ø–æ–∫ –Ω–∞ —Å—É–º–º—É:</b> {user.totalPurchasesFormatted}\n\n‚ú® –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ —Å–æ–≤–µ—Ä—à–∞—Ç—å –ø–æ–∫—É–ø–∫–∏ –¥–ª—è –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è –±–æ–Ω—É—Å–æ–≤!",
            "keyboard": {
              "type": "inline",
              "buttons": [
                [{ "text": "‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é", "callback_data": "back_to_menu" }]
              ]
            },
            "parseMode": "HTML"
          }
        }
      },
      "position": { "x": 406, "y": 549.5 }
    },
    {
      "id": "menu-history-trigger",
      "type": "trigger.callback",
      "data": {
        "label": "–¢—Ä–∏–≥–≥–µ—Ä: –ò—Å—Ç–æ—Ä–∏—è",
        "config": {
          "trigger.callback": {
            "callbackData": "menu_history"
          }
        }
      },
      "position": { "x": 0, "y": 791.5 }
    },
    {
      "id": "show-history-list",
      "type": "message",
      "data": {
        "label": "–ü–æ–∫–∞–∑–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—é",
        "config": {
          "message": {
            "text": "<b>üìú –ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π</b>\n\n<b>–ü–æ—Å–ª–µ–¥–Ω–∏–µ 10 –æ–ø–µ—Ä–∞—Ü–∏–π:</b>\n\n{transactions.formatted}\n\n–ü–æ–∫–∞–∑–∞–Ω—ã –ø–æ—Å–ª–µ–¥–Ω–∏–µ 10 –æ–ø–µ—Ä–∞—Ü–∏–π.\n\nüí° –î–ª—è –ø–æ–ª–Ω–æ–π –∏—Å—Ç–æ—Ä–∏–∏ –ø–æ—Å–µ—Ç–∏—Ç–µ –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç –Ω–∞ —Å–∞–π—Ç–µ.",
            "keyboard": {
              "type": "inline",
              "buttons": [
                [{ "text": "‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é", "callback_data": "back_to_menu" }]
              ]
            },
            "parseMode": "HTML"
          }
        }
      },
      "position": { "x": 406, "y": 791.5 }
    },
    {
      "id": "menu-level-trigger",
      "type": "trigger.callback",
      "data": {
        "label": "–¢—Ä–∏–≥–≥–µ—Ä: –£—Ä–æ–≤–µ–Ω—å",
        "config": {
          "trigger.callback": {
            "callbackData": "menu_level"
          }
        }
      },
      "position": { "x": 0, "y": 1033.5 }
    },
    {
      "id": "show-level-info",
      "type": "message",
      "data": {
        "label": "–ü–æ–∫–∞–∑–∞—Ç—å —É—Ä–æ–≤–µ–Ω—å",
        "config": {
          "message": {
            "text": "<b>üèÜ –í–∞—à —É—Ä–æ–≤–µ–Ω—å:</b> {user.currentLevel}\n\n<b>üìä –ü—Ä–æ–≥—Ä–µ—Å—Å –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —É—Ä–æ–≤–Ω—é:</b>\n{user.progressBar} ({user.progressPercent}%)\n\n<b>üí∞ –ë–æ–Ω—É—Å–Ω—ã–π –ø—Ä–æ—Ü–µ–Ω—Ç:</b> {user.levelBonusPercent}%\n<b>üíµ –ü—Ä–æ—Ü–µ–Ω—Ç –æ–ø–ª–∞—Ç—ã –±–æ–Ω—É—Å–∞–º–∏:</b> {user.levelPaymentPercent}%\n\n<b>–°–ª–µ–¥—É—é—â–∏–π —É—Ä–æ–≤–µ–Ω—å:</b> {user.nextLevelName}\n<b>–ù—É–∂–Ω–æ –ø–æ–∫—É–ø–æ–∫ –Ω–∞ —Å—É–º–º—É:</b> {user.nextLevelAmountFormatted}\n\nüéØ –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ —Å–æ–≤–µ—Ä—à–∞—Ç—å –ø–æ–∫—É–ø–∫–∏ –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è —É—Ä–æ–≤–Ω—è!",
            "keyboard": {
              "type": "inline",
              "buttons": [
                [{ "text": "‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é", "callback_data": "back_to_menu" }]
              ]
            },
            "parseMode": "HTML"
          }
        }
      },
      "position": { "x": 406, "y": 1033.5 }
    },
    {
      "id": "menu-referrals-trigger",
      "type": "trigger.callback",
      "data": {
        "label": "–¢—Ä–∏–≥–≥–µ—Ä: –†–µ—Ñ–µ—Ä–∞–ª—ã",
        "config": {
          "trigger.callback": {
            "callbackData": "menu_referrals"
          }
        }
      },
      "position": { "x": 0, "y": 1275.5 }
    },
    {
      "id": "show-referrals-stats",
      "type": "message",
      "data": {
        "label": "–ü–æ–∫–∞–∑–∞—Ç—å —Ä–µ—Ñ–µ—Ä–∞–ª—ã",
        "config": {
          "message": {
            "text": "<b>üë• –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞</b>\n\n<b>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:</b>\nüë§ <b>–ü—Ä–∏–≥–ª–∞—à–µ–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:</b> {user.referralCount}\nüí∞ <b>–ë–æ–Ω—É—Å–æ–≤ –æ—Ç —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤:</b> {user.referralBonusTotalFormatted}\n\n<b>üîó –í–∞—à–∞ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞:</b>\n{user.referralLink}\n\nüì± –ü–æ–¥–µ–ª–∏—Ç–µ—Å—å —Å—Å—ã–ª–∫–æ–π —Å –¥—Ä—É–∑—å—è–º–∏ –∏ –ø–æ–ª—É—á–∞–π—Ç–µ –±–æ–Ω—É—Å—ã –∑–∞ –∏—Ö –ø–æ–∫—É–ø–∫–∏!\n\nüí° –ü—Ä–∏–≥–ª–∞—à–∞–π—Ç–µ –¥—Ä—É–∑–µ–π –∏ –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞–π—Ç–µ –≤–º–µ—Å—Ç–µ!",
            "keyboard": {
              "type": "inline",
              "buttons": [
                [{ "text": "‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é", "callback_data": "back_to_menu" }]
              ]
            },
            "parseMode": "HTML"
          }
        }
      },
      "position": { "x": 406, "y": 1275.5 }
    },
    {
      "id": "menu-invite-trigger",
      "type": "trigger.callback",
      "data": {
        "label": "–¢—Ä–∏–≥–≥–µ—Ä: –ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å",
        "config": {
          "trigger.callback": {
            "callbackData": "menu_invite"
          }
        }
      },
      "position": { "x": 0, "y": 1517.5 }
    },
    {
      "id": "show-invite-info",
      "type": "message",
      "data": {
        "label": "–ü–æ–∫–∞–∑–∞—Ç—å –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ",
        "config": {
          "message": {
            "text": "<b>üîó –ü—Ä–∏–≥–ª–∞—Å–∏—Ç–µ –¥—Ä—É–∑–µ–π –∏ –ø–æ–ª—É—á–∞–π—Ç–µ –±–æ–Ω—É—Å—ã!</b>\n\n–ü–æ–¥–µ–ª–∏—Ç–µ—Å—å –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–π —Å—Å—ã–ª–∫–æ–π –∏ –ø–æ–ª—É—á–∞–π—Ç–µ –≤–æ–∑–Ω–∞–≥—Ä–∞–∂–¥–µ–Ω–∏–µ –∑–∞ –∫–∞–∂–¥—É—é –ø–æ–∫—É–ø–∫—É –ø—Ä–∏–≥–ª–∞—à—ë–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.\n\n<b>–í–∞—à–∞ —Å—Å—ã–ª–∫–∞:</b>\n{user.referralLink}\n\n1Ô∏è‚É£ –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å—Å—ã–ª–∫—É\n2Ô∏è‚É£ –û—Ç–ø—Ä–∞–≤—å—Ç–µ –¥—Ä—É–∑—å—è–º –≤ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–∞—Ö –∏–ª–∏ —Å–æ—Ü—Å–µ—Ç—è—Ö\n3Ô∏è‚É£ –ü–æ–ª—É—á–∞–π—Ç–µ –±–æ–Ω—É—Å—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏\n\nüéÅ –ë–æ–ª—å—à–µ –¥—Ä—É–∑–µ–π ‚Äî –±–æ–ª—å—à–µ –±–æ–Ω—É—Å–æ–≤!",
            "keyboard": {
              "type": "inline",
              "buttons": [
                [{ "text": "‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é", "callback_data": "back_to_menu" }]
              ]
            },
            "parseMode": "HTML"
          }
        }
      },
      "position": { "x": 406, "y": 1517.5 }
    },
    {
      "id": "menu-help-trigger",
      "type": "trigger.callback",
      "data": {
        "label": "–¢—Ä–∏–≥–≥–µ—Ä: –ü–æ–º–æ—â—å",
        "config": {
          "trigger.callback": {
            "callbackData": "menu_help"
          }
        }
      },
      "position": { "x": 0, "y": 1759.5 }
    },
    {
      "id": "show-help-info",
      "type": "message",
      "data": {
        "label": "–ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–º–æ—â—å",
        "config": {
          "message": {
            "text": "<b>‚ùì –ü–æ–º–æ—â—å</b>\n\n<b>üéØ –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–æ–Ω—É—Å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞:</b>\n\nüí∞ <b>–ë–æ–Ω—É—Å—ã</b> - –Ω–∞–∫–∞–ø–ª–∏–≤–∞–π—Ç–µ –±–æ–Ω—É—Å—ã –∑–∞ –ø–æ–∫—É–ø–∫–∏\nüõí <b>–°–ø–∏—Å–∞–Ω–∏–µ</b> - –æ–ø–ª–∞—á–∏–≤–∞–π—Ç–µ —á–∞—Å—Ç—å –ø–æ–∫—É–ø–∫–∏ –±–æ–Ω—É—Å–∞–º–∏\nüèÜ <b>–£—Ä–æ–≤–Ω–∏</b> - –ø–æ–≤—ã—à–∞–π—Ç–µ —É—Ä–æ–≤–µ–Ω—å –¥–ª—è –ª—É—á—à–∏—Ö —É—Å–ª–æ–≤–∏–π\nüë• <b>–†–µ—Ñ–µ—Ä–∞–ª—ã</b> - –ø—Ä–∏–≥–ª–∞—à–∞–π—Ç–µ –¥—Ä—É–∑–µ–π –∏ –ø–æ–ª—É—á–∞–π—Ç–µ –±–æ–Ω—É—Å—ã\n\n<b>üì± –ö–æ–º–∞–Ω–¥—ã:</b>\n‚Ä¢ /start - –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –±–æ—Ç–æ–º\n‚Ä¢ üí∞ –ë–∞–ª–∞–Ω—Å - –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ç–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å\n‚Ä¢ üìú –ò—Å—Ç–æ—Ä–∏—è - –∏—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π\n‚Ä¢ üèÜ –£—Ä–æ–≤–µ–Ω—å - –≤–∞—à —Ç–µ–∫—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å\n‚Ä¢ üë• –†–µ—Ñ–µ—Ä–∞–ª—ã - —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞\n‚Ä¢ üîó –ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å - –ø—Ä–∏–≥–ª–∞—Å–∏—Ç—å –¥—Ä—É–≥–∞\n\nüí¨ –ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –≤–æ–ø—Ä–æ—Å—ã, –Ω–∞–ø–∏—à–∏—Ç–µ –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É!",
            "keyboard": {
              "type": "inline",
              "buttons": [
                [{ "text": "‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é", "callback_data": "back_to_menu" }]
              ]
            },
            "parseMode": "HTML"
          }
        }
      },
      "position": { "x": 406, "y": 1759.5 }
    },
    {
      "id": "menu-main-trigger",
      "type": "trigger.callback",
      "data": {
        "label": "–¢—Ä–∏–≥–≥–µ—Ä: –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é",
        "config": {
          "trigger.callback": {
            "callbackData": "menu_main"
          }
        }
      },
      "position": { "x": 1218, "y": 252 }
    },
    {
      "id": "back-to-menu-trigger",
      "type": "trigger.callback",
      "data": {
        "label": "–¢—Ä–∏–≥–≥–µ—Ä: –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é",
        "config": {
          "trigger.callback": {
            "callbackData": "back_to_menu"
          }
        }
      },
      "position": { "x": 1218, "y": 494 }
    }
  ],
  "connections": [
    { "id": "c1", "source": "start-trigger", "target": "check-telegram-user" },
    { "id": "c-contact-1", "source": "contact-trigger", "target": "check-contact-user" },
    { "id": "c-contact-2", "source": "check-contact-user", "target": "check-contact-user-exists" },
    { "id": "c-contact-3", "source": "check-contact-user-exists", "target": "save-contact-phone", "sourceHandle": "true" },
    { "id": "c-contact-4", "source": "check-contact-user-exists", "target": "contact-user-not-found", "sourceHandle": "false" },
    { "id": "c-contact-5", "source": "save-contact-phone", "target": "contact-saved-message" },
    { "id": "c2", "source": "check-telegram-user", "target": "check-user-status" },
    { "id": "c3", "source": "check-user-status", "target": "check-user-active", "sourceHandle": "true" },
    { "id": "c4", "source": "check-user-status", "target": "request-email", "sourceHandle": "false" },
    { "id": "c5", "source": "check-user-active", "target": "active-user-profile", "sourceHandle": "true" },
    { "id": "c6", "source": "check-user-active", "target": "request-email", "sourceHandle": "false" },
    { "id": "c7", "source": "request-email", "target": "wait-email-input" },
    { "id": "c7b", "source": "wait-email-input", "target": "check-email-user" },
    { "id": "c8", "source": "check-email-user", "target": "check-email-found" },
    { "id": "c9", "source": "check-email-found", "target": "check-telegram-already-linked", "sourceHandle": "true" },
    { "id": "c10", "source": "check-email-found", "target": "website-registration", "sourceHandle": "false" },
    { "id": "c11", "source": "check-telegram-already-linked", "target": "already-active-message", "sourceHandle": "true" },
    { "id": "c12", "source": "check-telegram-already-linked", "target": "activate-user", "sourceHandle": "false" },
    { "id": "c13", "source": "activate-user", "target": "check-welcome-bonus" },
    { "id": "c14", "source": "check-welcome-bonus", "target": "check-bonus-exists" },
    { "id": "c15", "source": "check-bonus-exists", "target": "add-welcome-bonus", "sourceHandle": "true" },
    { "id": "c16", "source": "check-bonus-exists", "target": "request-birthday", "sourceHandle": "false" },
    { "id": "c17", "source": "add-welcome-bonus", "target": "request-birthday" },
    { "id": "c18", "source": "request-birthday", "target": "wait-birthday-input" },
    { "id": "c18b", "source": "wait-birthday-input", "target": "check-birthday-skip" },
    { "id": "c18c", "source": "check-birthday-skip", "target": "request-phone", "sourceHandle": "true" },
    { "id": "c18d", "source": "check-birthday-skip", "target": "save-birthday", "sourceHandle": "false" },
    { "id": "c19", "source": "save-birthday", "target": "request-phone" },
    { "id": "c20", "source": "request-phone", "target": "wait-phone-input" },
    { "id": "c20b", "source": "wait-phone-input", "target": "check-phone-skip" },
    { "id": "c20c", "source": "check-phone-skip", "target": "success-message", "sourceHandle": "true" },
    { "id": "c20d", "source": "check-phone-skip", "target": "save-phone", "sourceHandle": "false" },
    { "id": "c21", "source": "save-phone", "target": "success-message" },
    { "id": "c22", "source": "retry-email-trigger", "target": "request-email" },
    { "id": "c23", "source": "menu-balance-trigger", "target": "show-balance-details" },
    { "id": "c24", "source": "menu-history-trigger", "target": "show-history-list" },
    { "id": "c25", "source": "menu-level-trigger", "target": "show-level-info" },
    { "id": "c26", "source": "menu-referrals-trigger", "target": "show-referrals-stats" },
    { "id": "c27", "source": "menu-invite-trigger", "target": "show-invite-info" },
    { "id": "c28", "source": "menu-help-trigger", "target": "show-help-info" },
    { "id": "c29", "source": "menu-main-trigger", "target": "active-user-profile" },
    { "id": "c30", "source": "back-to-menu-trigger", "target": "active-user-profile" }
  ],
  "variables": [
    {
      "id": "telegramUser",
      "name": "telegramUser",
      "type": "object",
      "description": "–î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ Telegram ID"
    },
    {
      "id": "emailUser",
      "name": "emailUser",
      "type": "object",
      "description": "–î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ Email"
    }
  ],
  "settings": {
    "autoSave": true,
    "gridSnap": true,
    "retryAttempts": 3,
    "maxExecutionTime": 60000
  }
}
