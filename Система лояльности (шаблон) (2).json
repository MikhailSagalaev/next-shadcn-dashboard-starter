{
  "id": "cmgqm22x90001v8c8yz6gj4q7",
  "projectId": "cmgntgsdv0000v8mwfwwh30az",
  "name": "–°–∏—Å—Ç–µ–º–∞ –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏ (—à–∞–±–ª–æ–Ω)",
  "description": "–£–º–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏: –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤—ã—Ö –∏ –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã—Ö –±–æ–Ω—É—Å–æ–≤",
  "isActive": true,
  "nodes": [
    {
      "id": "start-trigger",
      "data": {
        "label": "–ö–æ–º–∞–Ω–¥–∞ /start",
        "config": {
          "trigger.command": {
            "command": "/start"
          }
        }
      },
      "type": "trigger.command",
      "dragging": false,
      "measured": {
        "width": 256,
        "height": 122
      },
      "position": {
        "x": -21.54884547069273,
        "y": 208.0142095914742
      },
      "selected": false
    },
    {
      "id": "check-existing-user",
      "data": {
        "label": "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",
        "config": {
          "action.database_query": {
            "query": "check_user_by_telegram",
            "parameters": {
              "telegramId": "{{telegram.userId}}"
            },
            "assignTo": "user"
          }
        }
      },
      "type": "action.database_query",
      "dragging": false,
      "measured": {
        "width": 256,
        "height": 142
      },
      "position": {
        "x": 269.8579040852576,
        "y": 197.3285968028419
      },
      "selected": false
    },
    {
      "id": "user-exists-check",
      "data": {
        "label": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å—É—â–µ—Å—Ç–≤—É–µ—Ç?",
        "config": {
          "condition": {
            "variable": "user",
            "operator": "is_not_empty"
          }
        }
      },
      "type": "condition",
      "dragging": false,
      "measured": {
        "width": 256,
        "height": 142
      },
      "position": {
        "x": 580.0195381882771,
        "y": 196.6767317939609
      },
      "selected": false
    },
    {
      "id": "welcome-message",
      "data": {
        "label": "–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –¥–ª—è –Ω–æ–≤—ã—Ö",
        "config": {
          "message": {
            "text": "üéÅ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –ø—Ä–æ–≥—Ä–∞–º–º—É –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏!\n\nüí∞ –ü–æ–ª—É—á–∏—Ç–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–µ –±–æ–Ω—É—Å—ã –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å!\n\nüì± –î–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥–µ–ª–∏—Ç–µ—Å—å –≤–∞—à–∏–º –Ω–æ–º–µ—Ä–æ–º —Ç–µ–ª–µ—Ñ–æ–Ω–∞.\n\n‚ú® –ü–æ—Å–ª–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –≤—ã –ø–æ–ª—É—á–∏—Ç–µ:\n‚Ä¢ 100 –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã—Ö –±–æ–Ω—É—Å–æ–≤\n‚Ä¢ –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–π –∫–æ–¥\n‚Ä¢ –î–æ—Å—Ç—É–ø –∫ –ø—Ä–æ–≥—Ä–∞–º–º–µ –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏",
            "keyboard": {
              "type": "reply",
              "buttons": [
                [
                  {
                    "text": "üì± –ü–æ–¥–µ–ª–∏—Ç—å—Å—è –Ω–æ–º–µ—Ä–æ–º",
                    "request_contact": true
                  }
                ]
              ]
            }
          }
        },
        "description": ""
      },
      "type": "message",
      "dragging": false,
      "measured": {
        "width": 256,
        "height": 142
      },
      "position": {
        "x": 890.0195381882771,
        "y": 50.6767317939609
      },
      "selected": false
    },
    {
      "id": "check-user",
      "data": {
        "label": "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ –∫–æ–Ω—Ç–∞–∫—Ç—É",
        "config": {
          "action.database_query": {
            "query": "check_user_by_telegram",
            "parameters": {
              "phone": "{{telegram.contact.phoneNumber}}",
              "telegramId": "{{telegram.userId}}"
            },
            "assignTo": "userByContact"
          }
        }
      },
      "type": "action.database_query",
      "dragging": false,
      "measured": {
        "width": 256,
        "height": 142
      },
      "position": {
        "x": 1510.0195381882771,
        "y": 50.6767317939609
      },
      "selected": false
    },
    {
      "id": "is-new-user",
      "data": {
        "label": "–ù–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å?",
        "config": {
          "condition": {
            "variable": "userByContact",
            "operator": "is_empty"
          }
        }
      },
      "type": "condition",
      "dragging": false,
      "measured": {
        "width": 256,
        "height": 142
      },
      "position": {
        "x": 631.1687388987567,
        "y": 396.348134991119
      },
      "selected": false
    },
    {
      "id": "create-user",
      "data": {
        "label": "–°–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",
        "config": {
          "action.database_query": {
            "query": "create_user",
            "parameters": {
              "email": "{{telegram.message.text}}",
              "phone": "{{telegram.contact.phoneNumber}}",
              "username": "{{telegram.username}}",
              "firstName": "{{telegram.contact.firstName}}",
              "telegramId": "{{telegram.userId}}"
            }
          }
        }
      },
      "type": "action.database_query",
      "dragging": false,
      "measured": {
        "width": 256,
        "height": 142
      },
      "position": {
        "x": 967.9893428063943,
        "y": 197.50621669627
      },
      "selected": false
    },
    {
      "id": "add-welcome-bonus",
      "data": {
        "label": "–ù–∞—á–∏—Å–ª–∏—Ç—å –±–æ–Ω—É—Å—ã",
        "config": {
          "action.database_query": {
            "query": "add_bonus",
            "parameters": {
              "type": "WELCOME",
              "amount": 100,
              "userId": "{{user.id}}",
              "description": "–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–µ –±–æ–Ω—É—Å—ã"
            }
          }
        }
      },
      "type": "action.database_query",
      "dragging": false,
      "measured": {
        "width": 256,
        "height": 142
      },
      "position": {
        "x": 1267.410301953819,
        "y": 198.841918294849
      },
      "selected": false
    },
    {
      "id": "success-new-user",
      "data": {
        "label": "–£—Å–ø–µ—à–Ω–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è",
        "config": {
          "message": {
            "text": "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º —Å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–µ–π, {user.firstName}!\n\nüí∞ –í–∞–º –Ω–∞—á–∏—Å–ª–µ–Ω–æ 100 –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã—Ö –±–æ–Ω—É—Å–æ–≤!\n\nüìä –í–∞—à –ø—Ä–æ—Ñ–∏–ª—å:\n‚Ä¢ –ë–∞–ª–∞–Ω—Å: {user.balanceFormatted}\n‚Ä¢ –£—Ä–æ–≤–µ–Ω—å: {user.currentLevel}\n‚Ä¢ –†–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–π –∫–æ–¥: {user.referralCode}\n\n‚ú® –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–æ–Ω—É—Å—ã –¥–ª—è –ø–æ–∫—É–ø–æ–∫ –∏ –ø—Ä–∏–≥–ª–∞—à–∞–π—Ç–µ –¥—Ä—É–∑–µ–π!"
          }
        }
      },
      "type": "message",
      "dragging": false,
      "measured": {
        "width": 256,
        "height": 162
      },
      "position": {
        "x": 1560.152753108348,
        "y": 193.4991119005329
      },
      "selected": false
    },
    {
      "id": "existing-user-message",
      "data": {
        "label": "–£–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω",
        "config": {
          "message": {
            "text": "üëã –†–∞–¥—ã –≤–∏–¥–µ—Ç—å –≤–∞—Å —Å–Ω–æ–≤–∞, {user.firstName}!\n\nüí∞ –í–∞—à —Ç–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å: {user.balanceFormatted}\n\nüìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:\n‚Ä¢ –ó–∞—Ä–∞–±–æ—Ç–∞–Ω–æ: {user.totalEarnedFormatted}\n‚Ä¢ –ü–æ—Ç—Ä–∞—á–µ–Ω–æ: {user.totalSpentFormatted}\n‚Ä¢ –ü–æ–∫—É–ø–æ–∫ –Ω–∞ —Å—É–º–º—É: {user.totalPurchasesFormatted}\n‚Ä¢ –£—Ä–æ–≤–µ–Ω—å: {user.currentLevel}\n\nüõçÔ∏è –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –¥–µ–ª–∞—Ç—å –ø–æ–∫—É–ø–∫–∏ –∏ –∫–æ–ø–∏—Ç—å –±–æ–Ω—É—Å—ã!\n\nüéÅ –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞:\n–í–∞—à –∫–æ–¥: {user.referralCode}\n–°—Å—ã–ª–∫–∞: {user.referralLink}"
          }
        }
      },
      "type": "message",
      "dragging": false,
      "measured": {
        "width": 256,
        "height": 162
      },
      "position": {
        "x": 1016.07460035524,
        "y": 458.9484902309059
      },
      "selected": false
    },
    {
      "id": "end-node",
      "data": {
        "label": "–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ",
        "config": {
          "flow.end": {
            "success": true
          }
        }
      },
      "type": "flow.end",
      "dragging": false,
      "measured": {
        "width": 256,
        "height": 78
      },
      "position": {
        "x": 1341.321492007105,
        "y": 750.3090586145647
      },
      "selected": false
    }
  ],
  "connections": [
    {
      "id": "start-to-check-existing",
      "type": "default",
      "source": "start-trigger",
      "target": "check-existing-user",
      "sourceHandle": "output",
      "targetHandle": "input"
    },
    {
      "id": "check-existing-to-condition",
      "type": "default",
      "source": "check-existing-user",
      "target": "user-exists-check",
      "sourceHandle": "output",
      "targetHandle": "input"
    },
    {
      "id": "condition-to-welcome",
      "type": "false",
      "source": "user-exists-check",
      "target": "welcome-message",
      "sourceHandle": "false",
      "targetHandle": "input"
    },
    {
      "id": "welcome-to-check",
      "type": "default",
      "source": "welcome-message",
      "target": "check-user",
      "sourceHandle": "output",
      "targetHandle": "input"
    },
    {
      "id": "check-to-condition",
      "type": "default",
      "source": "check-user",
      "target": "is-new-user",
      "sourceHandle": "output",
      "targetHandle": "input"
    },
    {
      "id": "condition-to-create",
      "type": "true",
      "source": "is-new-user",
      "target": "create-user",
      "sourceHandle": "true",
      "targetHandle": "input"
    },
    {
      "id": "create-to-bonus",
      "type": "default",
      "source": "create-user",
      "target": "add-welcome-bonus",
      "sourceHandle": "output",
      "targetHandle": "input"
    },
    {
      "id": "bonus-to-success",
      "type": "default",
      "source": "add-welcome-bonus",
      "target": "success-new-user",
      "sourceHandle": "output",
      "targetHandle": "input"
    },
    {
      "id": "success-to-end",
      "type": "default",
      "source": "success-new-user",
      "target": "end-node",
      "sourceHandle": "output",
      "targetHandle": "input"
    },
    {
      "id": "condition-to-existing",
      "type": "false",
      "source": "is-new-user",
      "target": "existing-user-message",
      "sourceHandle": "false",
      "targetHandle": "input"
    },
    {
      "id": "user-exists-to-existing",
      "type": "true",
      "source": "user-exists-check",
      "target": "existing-user-message",
      "sourceHandle": "true",
      "targetHandle": "input"
    },
    {
      "id": "existing-to-end",
      "type": "default",
      "source": "existing-user-message",
      "target": "end-node",
      "sourceHandle": "output",
      "targetHandle": "input"
    },
    {
      "id": "edge-start-trigger-check-existing-user-1760449336408",
      "type": "default",
      "source": "start-trigger",
      "target": "check-existing-user",
      "animated": true
    },
    {
      "id": "edge-check-existing-user-user-exists-check-1760449336409",
      "type": "default",
      "source": "check-existing-user",
      "target": "user-exists-check",
      "animated": true
    },
    {
      "id": "edge-user-exists-check-welcome-message-1760449336410",
      "type": "default",
      "source": "user-exists-check",
      "target": "welcome-message",
      "animated": true,
      "sourceHandle": "false"
    },
    {
      "id": "edge-user-exists-check-existing-user-message-1760449336411",
      "type": "default",
      "source": "user-exists-check",
      "target": "existing-user-message",
      "animated": true,
      "sourceHandle": "true"
    },
    {
      "id": "edge-welcome-message-check-user-1760449344083",
      "type": "default",
      "source": "welcome-message",
      "target": "check-user",
      "animated": true
    },
    {
      "id": "edge-check-user-is-new-user-1760449346456",
      "type": "default",
      "source": "check-user",
      "target": "is-new-user",
      "animated": true
    },
    {
      "id": "edge-is-new-user-create-user-1760449350187",
      "type": "default",
      "source": "is-new-user",
      "target": "create-user",
      "animated": true,
      "sourceHandle": "true"
    },
    {
      "id": "edge-create-user-add-welcome-bonus-1760449354323",
      "type": "default",
      "source": "create-user",
      "target": "add-welcome-bonus",
      "animated": true
    },
    {
      "id": "edge-add-welcome-bonus-success-new-user-1760449360667",
      "type": "default",
      "source": "add-welcome-bonus",
      "target": "success-new-user",
      "animated": true
    },
    {
      "id": "edge-success-new-user-end-node-1760449365359",
      "type": "default",
      "source": "success-new-user",
      "target": "end-node",
      "animated": true
    },
    {
      "id": "edge-is-new-user-existing-user-message-1760449369999",
      "type": "default",
      "source": "is-new-user",
      "target": "existing-user-message",
      "animated": true,
      "sourceHandle": "false"
    },
    {
      "id": "edge-existing-user-message-end-node-1760449371883",
      "type": "default",
      "source": "existing-user-message",
      "target": "end-node",
      "animated": true
    }
  ],
  "variables": [
    {
      "id": "user",
      "name": "user",
      "type": "object",
      "description": "–î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",
      "defaultValue": null
    },
    {
      "id": "welcome_bonus",
      "name": "welcome_bonus",
      "type": "number",
      "description": "–†–∞–∑–º–µ—Ä –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –±–æ–Ω—É—Å–∞",
      "defaultValue": 100
    }
  ],
  "settings": {
    "retryAttempts": 3,
    "maxExecutionTime": 60000
  },
  "createdAt": "2025-10-14T13:41:36.717Z",
  "updatedAt": "2025-10-15T07:17:53.403Z"
}