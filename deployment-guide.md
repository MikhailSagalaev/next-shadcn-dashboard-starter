# üöÄ –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é SaaS Bonus System

## üìã –û–±–∑–æ—Ä –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

### 1. **üåê –ë—ã—Å—Ç—Ä–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: ngrok (–ª–æ–∫–∞–ª—å–Ω–æ + —Ç—É–Ω–Ω–µ–ª—å)**

```bash
# 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ ngrok
npm install -g ngrok

# 2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç –ª–æ–∫–∞–ª—å–Ω–æ
pnpm dev

# 3. –í –Ω–æ–≤–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ —Å–æ–∑–¥–∞–π—Ç–µ —Ç—É–Ω–Ω–µ–ª—å
ngrok http 3000
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ü–æ–ª—É—á–∏—Ç–µ URL —Ç–∏–ø–∞ `https://abc123.ngrok.io`

**–ü–ª—é—Å—ã**: 
- ‚úÖ –ë—ã—Å—Ç—Ä–æ (5 –º–∏–Ω—É—Ç)
- ‚úÖ –ë–µ—Å–ø–ª–∞—Ç–Ω–æ
- ‚úÖ –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è webhook'–æ–≤

**–ú–∏–Ω—É—Å—ã**: 
- ‚ùå URL –º–µ–Ω—è–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ
- ‚ùå –ù–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

---

### 2. **‚òÅÔ∏è –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ: Vercel (–±–µ—Å–ø–ª–∞—Ç–Ω–æ)**

```bash
# 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Vercel CLI
npm install -g vercel

# 2. –í–æ–π–¥–∏—Ç–µ –≤ –∞–∫–∫–∞—É–Ω—Ç
vercel login

# 3. –î–µ–ø–ª–æ–π –ø—Ä–æ–µ–∫—Ç–∞
vercel --prod
```

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ Vercel:**
```bash
# –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∏–ª–∏ CLI:
vercel env add DATABASE_URL
vercel env add NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY
vercel env add CLERK_SECRET_KEY
```

**–ü–ª—é—Å—ã**:
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π HTTPS
- ‚úÖ CDN –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å GitHub
- ‚úÖ –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø–ª–∞–Ω –¥–ª—è —Å—Ç–∞—Ä—Ç–∞–ø–æ–≤

---

### 3. **üê≥ Docker —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ**

#### A. –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ —Å Docker Compose

```bash
# 1. –°–æ–∑–¥–∞–π—Ç–µ .env —Ñ–∞–π–ª:
cp .env.example .env
# –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

# 2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç
docker-compose up -d

# 3. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –ë–î
docker-compose exec app npx prisma migrate deploy
```

#### B. –ù–∞ –æ–±–ª–∞—á–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ (DigitalOcean, AWS, etc.)

```bash
# 1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone your-repo
cd your-project

# 2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
nano .env

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ
docker-compose up -d

# 4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Nginx (–æ–±—Ä–∞—Ç–Ω—ã–π –ø—Ä–æ–∫—Å–∏)
# –°–º. –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –Ω–∏–∂–µ
```

---

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:

```env
# Database
DATABASE_URL="postgresql://user:password@host:5432/database"

# Clerk Auth
NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY="pk_live_xxx"
CLERK_SECRET_KEY="sk_live_xxx"

# App Config
NEXTAUTH_URL="https://your-domain.com"
NEXTAUTH_SECRET="32-character-secret"
WEBHOOK_BASE_URL="https://your-domain.com"
CRON_SECRET="your-cron-secret"
```

---

## üóÑÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –í–∞—Ä–∏–∞–Ω—Ç 1: –û–±–ª–∞—á–Ω–∞—è –ë–î (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ)
- **Neon.tech** (–±–µ—Å–ø–ª–∞—Ç–Ω–æ –¥–æ 0.5GB)
- **PlanetScale** (–±–µ—Å–ø–ª–∞—Ç–Ω–æ –¥–æ 5GB)
- **Supabase** (–±–µ—Å–ø–ª–∞—Ç–Ω–æ –¥–æ 500MB)

### –í–∞—Ä–∏–∞–Ω—Ç 2: Self-hosted PostgreSQL

```bash
# Docker
docker run --name postgres-bonus \
  -e POSTGRES_USER=bonus_admin \
  -e POSTGRES_PASSWORD=secure_password \
  -e POSTGRES_DB=bonus_system \
  -p 5432:5432 \
  -d postgres:15

# –í—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏
npx prisma migrate deploy
```

---

## üîÑ –ü—Ä–æ—Ü–µ—Å—Å –¥–µ–ø–ª–æ—è (—à–∞–≥ –∑–∞ —à–∞–≥–æ–º)

### 1. **–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞**
```bash
# 1. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –ø—Ä–æ–µ–∫—Ç —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è
pnpm build

# 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ TypeScript
npx tsc --noEmit

# 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–∏–Ω—Ç–µ—Ä
pnpm lint
```

### 2. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**
```bash
# 1. –°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–æ–¥–∞–∫—à–µ–Ω –ë–î
# 2. –û–±–Ω–æ–≤–∏—Ç–µ DATABASE_URL –≤ .env
# 3. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏
npx prisma migrate deploy
# 4. –°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –∫–ª–∏–µ–Ω—Ç Prisma
npx prisma generate
```

### 3. **Vercel –¥–µ–ø–ª–æ–π**
```bash
# 1. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∫ Vercel
# 2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
# 3. –î–µ–ø–ª–æ–π –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
```

### 4. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–µ–ø–ª–æ—è**
```bash
# –¢–µ—Å—Ç–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã:
curl https://your-domain.com/api/health
curl -X POST https://your-domain.com/api/webhook/test-secret \
  -H "Content-Type: application/json" \
  -d '{"action": "test"}'
```

---

## üì° –ù–∞—Å—Ç—Ä–æ–π–∫–∞ webhook'–æ–≤

### Tilda Integration:
1. –ó–∞–π–¥–∏—Ç–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞ Tilda
2. –î–æ–±–∞–≤—å—Ç–µ webhook URL: `https://your-domain.com/api/webhook/[your-webhook-secret]`
3. –í–∫–ª—é—á–∏—Ç–µ –æ—Ç–ø—Ä–∞–≤–∫—É –¥–∞–Ω–Ω—ã—Ö –æ –∑–∞–∫–∞–∑–∞—Ö

### –î—Ä—É–≥–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:
- **WooCommerce**: –ü–ª–∞–≥–∏–Ω webhooks
- **Shopify**: Settings ‚Üí Notifications ‚Üí Webhooks
- **Custom**: POST –∑–∞–ø—Ä–æ—Å –Ω–∞ –≤–∞—à webhook endpoint

---

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ

### 1. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```bash
# –ì–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ —Å–∏–ª—å–Ω—ã–µ —Å–µ–∫—Ä–µ—Ç—ã:
openssl rand -base64 32  # –¥–ª—è NEXTAUTH_SECRET
openssl rand -hex 16     # –¥–ª—è CRON_SECRET
```

### 2. Database Security
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ SSL —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- –û–≥—Ä–∞–Ω–∏—á—å—Ç–µ –¥–æ—Å—Ç—É–ø –ø–æ IP
- –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –±—ç–∫–∞–ø—ã

### 3. Rate Limiting
```typescript
// –£–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –≤ –ø—Ä–æ–µ–∫—Ç–µ
// src/lib/rate-limiter.ts
```

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –õ–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:
```bash
# Docker
docker-compose logs -f app

# Vercel
vercel logs your-deployment-url
```

### Telegram –±–æ—Ç—ã —Å—Ç–∞—Ç—É—Å:
```bash
curl https://your-domain.com/api/admin/bots/init
```

---

## üö® Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: "Database connection failed"
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ DATABASE_URL
echo $DATABASE_URL

# –¢–µ—Å—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
npx prisma db pull
```

### –ü—Ä–æ–±–ª–µ–º–∞: "Webhook –Ω–µ –ø—Ä–∏—Ö–æ–¥—è—Ç"
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ webhook URL
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —Å–µ—Ä–≤–∏—Å –∑–∞–ø—É—â–µ–Ω
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `docker-compose logs app`

### –ü—Ä–æ–±–ª–µ–º–∞: "Telegram –±–æ—Ç—ã –Ω–µ –æ—Ç–≤–µ—á–∞—é—Ç"
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å –±–æ—Ç–æ–≤
curl https://your-domain.com/api/admin/bots/init

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–æ–≤
curl -X POST https://your-domain.com/api/admin/bots/init
```

---

## üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ ngrok
2. **–î–ª—è MVP/—Å—Ç–∞—Ä—Ç–∞–ø–∞**: Vercel + Neon.tech (–±–µ—Å–ø–ª–∞—Ç–Ω–æ)
3. **–î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞**: VPS + Docker + PostgreSQL
4. **–î–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è**: Kubernetes + –æ–±–ª–∞—á–Ω–∞—è –ë–î

---

**üéØ –ò—Ç–æ–≥**: –°–∞–º—ã–π –±—ã—Å—Ç—Ä—ã–π —Å–ø–æ—Å–æ–± –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å webhook –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é - —ç—Ç–æ ngrok (5 –º–∏–Ω—É—Ç) –∏–ª–∏ Vercel –¥–µ–ø–ª–æ–π (15 –º–∏–Ω—É—Ç).
